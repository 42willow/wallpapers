---
import type { ImageMetadata } from "astro";
import { Image } from "astro:assets";

interface Props {
  images: Record<string, () => Promise<{ default: ImageMetadata }>>;
  imagePath: string;
  name: string;
  flavour: string;
  author?: string;
  class?: string;
}

const {
  images,
  imagePath,
  name,
  flavour,
  author,
  class: className,
} = Astro.props;
if (!images[imagePath])
  throw new Error(`"${imagePath}" does not exist in glob`);

const imageMetadata = await images[imagePath]();
---

<div class:list={["card", className, flavour]} data-imagePath={imagePath}>
  <div class="group relative rounded-lg overflow-hidden">
    <Image
      src={images[imagePath]()}
      alt={author ? `${name} by ${author}` : name}
      width={800}
      quality={"mid"}
      class="wallpaper"
    />
    <div
      class="flex justify-between p-3 absolute bg-ctp-surface0/80 transition-opacity duration-300 group-hover:opacity-100 opacity-0 top-0 left-0 w-full min-h-12"
    >
      <div>
        <span class="font-bold">{name.replaceAll("_", " ")}</span>
        <span>{author ? `by ${author}` : ""}</span>
      </div>
      <div>
        <span class=""
          >{imageMetadata.default.width} x {imageMetadata.default.height} pixels</span
        >
      </div>
    </div>
  </div>
</div>
